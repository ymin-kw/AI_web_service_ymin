<!DOCTYPE html>
<html lang="ko">
<head>
<meta charset="UTF-8" />
<title>삼성 라이온즈 선수 검색 (AI 서비스)</title>

<link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;600;700&family=Pretendard:wght@300;400;600;700&display=swap" rel="stylesheet">

<style>
  body {
    margin: 0;
    /* 배경 이미지는 기존 경로 유지 */
    background: url('file:///C:/Users/KW/Desktop/웹페이지/samsung_lions_stadium.png') no-repeat center center fixed;
    background-size: cover;
    
    font-family: 'Inter', 'Pretendard', sans-serif;
    color: white;
    text-align: center;
    min-height: 100vh;
  }

  .container {
    max-width: 900px;
    margin: 0 auto; 
    padding: 20px;
    min-height: 100vh;
    display: flex;
    flex-direction: column;
    justify-content: flex-start;
    align-items: center;
  }

  .title-overlay {
    font-size: 54px; 
    font-weight: 700;
    margin: 150px 0 25px 0;
    text-shadow: 0 4px 10px rgba(0,0,0,0.7); 
    letter-spacing: 2px;
    text-transform: uppercase;
    z-index: 10;
    font-family: 'Inter', sans-serif; 
    color: #ffffff; 
  }
  
  #logo {
    display: none; 
  }

  /* 검색 박스 */
  .search-box {
    position: relative;
    display: flex;
    gap: 12px;
    justify-content: center;
    margin-bottom: 0;
    z-index: 10;
  }

  input {
    padding: 14px;
    width: 300px;
    border-radius: 14px;
    border: 1px solid rgba(255,255,255,0.2);
    background: rgba(255,255,255,0.12);
    color: white;
    font-size: 16px;
    backdrop-filter: blur(10px);
  }

  input::placeholder {
    color: rgba(255,255,255,0.6);
  }

  button {
    padding: 14px 24px;
    background: white;
    color: #003cb3;
    border: none;
    font-weight: 700;
    border-radius: 14px;
    cursor: pointer;
    transition: 0.2s;
  }

  button:hover {
    transform: translateY(-2px);
    box-shadow: 0 6px 16px rgba(0,0,0,0.25);
  }

  /* 자동완성 리스트 */
  #autocompleteList {
    position: absolute;
    top: 55px;
    width: 300px;
    background: rgba(255,255,255,0.12);
    backdrop-filter: blur(12px);
    border-radius: 12px;
    overflow: hidden;
    text-align: left;
    box-shadow: 0 8px 25px rgba(0,0,0,0.35);
    display: none;
    animation: fadeIn 0.15s ease-out;
  }

  .autocomplete-item {
    padding: 12px 16px;
    cursor: pointer;
    border-bottom: 1px solid rgba(255,255,255,0.08);
    transition: 0.2s;
  }

  .autocomplete-item:hover {
    background: rgba(0, 153, 255, 0.35);
    border-left: 3px solid #4fd1ff;
    padding-left: 20px;
  }

  @keyframes fadeIn {
    from { opacity: 0; transform: translateY(-4px); }
    to { opacity: 1; transform: translateY(0); }
  }

  /* 선수 카드 (AI 결과 표시용으로 재사용) */
  .player-card {
    background: rgba(255,255,255,0.12);
    backdrop-filter: blur(12px);
    border-radius: 18px;
    padding: 22px;
    margin-top: 24px;
    text-align: left;
    color: white;
    box-shadow: 0 10px 30px rgba(2,8,40,0.45);
    max-width: 700px;
    margin-left: auto;
    margin-right: auto;
    animation: fadeIn 0.25s ease-out;
  }

  .player-card h2 {
    margin: 0 0 8px;
    font-size: 22px;
  }
  .player-card p {
    font-size: 16px; 
    line-height: 1.8; 
    white-space: pre-wrap; 
    margin: 0;
  }

  .player-row {
    display:none; /* 기존 통계 로직 숨김 */
  }

  hr.separator {
    border:0;
    border-top:1px solid rgba(255,255,255,0.08);
    margin:12px 0;
  }
</style>
</head>

<body>
<div class="container">

  <h1 class="title-overlay">SAMSUNG LIONS AI 분석</h1>

  <div class="search-box">
    <input id="playerInput" placeholder="선수 이름 입력 (예: 강민호) 후 엔터 또는 검색">
    <button id="searchBtn">AI 분석</button>

        <div id="autocompleteList"></div>
  </div>

  <div id="resultArea">
    <div class="player-card" style="margin-top: 50px;">
      <h2>사용법 안내</h2>
      <hr class="separator">
      <p>선수 이름을 입력하고 'AI 분석' 버튼을 누르면,<br>백엔드 서버를 통해 Gemini AI가 해당 선수에 대한 분석 결과를 여기에 표시합니다.</p>
    </div>
  </div>

</div>

<script>
// ============================================================
// 1. 통신 규격 설정 (상수)
// ============================================================
// ※ Replit에서 실행 중인 백엔드 주소로 반드시 교체해야 합니다!
const BACKEND_BASE_URL = "https://e37e563b-0b2a-4497-9338-611d4a6118d7-00-1unbj00beh2mg.pike.replit.dev"; 
const AI_URL = BACKEND_BASE_URL + "/ai";

// ============================================================
// 2. 입력값 수집 및 AI 호출 함수
// ============================================================

// [필수조건 1] 입력값 수집 함수
function collectInputsFromPage() {
    const inputElement = document.getElementById("playerInput");
    return {
        playerName: inputElement.value.trim() // 'playerName'이라는 키로 저장
    };
}

// [필수조건: 통신 함수] 백엔드와 fetch 통신
async function callAI(inputs) {
    try {
        const response = await fetch(AI_URL, {
            method: "POST",
            headers: { "Content-Type": "application/json" },
            body: JSON.stringify({ inputs: inputs })
        });

        if (!response.ok) {
            throw new Error(`서버 응답 오류: ${response.status}`);
        }

        const data = await response.json();
        return data.answer; // 규격대로 answer 문자열 반환

    } catch (error) {
        console.error("AI 호출 중 에러:", error);
        return `[통신 오류] 서버와 연결할 수 없습니다. (${error.message})`;
    }
}

// [필수조건 2, 3] 버튼 클릭 핸들러 (실행 -> 출력)
async function onRunAIButtonClicked() {
    const resultArea = document.getElementById("resultArea");
    const inputs = collectInputsFromPage();

    // 입력값이 없을 경우 처리
    if (!inputs.playerName) {
        alert("선수 이름을 입력해주세요.");
        return;
    }

    // 로딩 화면 표시 (기존 스타일 활용)
    resultArea.innerHTML = `
      <div class="player-card">
        <h2>AI 분석 중...</h2>
        <hr class="separator">
        <p>선수 '${inputs.playerName}'에 대한 데이터를 분석하고 있습니다...</p>
      </div>
    `;

    // AI 함수 호출
    const answer = await callAI(inputs);

    // 결과 화면 표시
    const title = answer.includes("오류") ? "분석 오류" : `AI 분석 결과: ${inputs.playerName}`;
    resultArea.innerHTML = `
      <div class="player-card">
        <h2>${title}</h2>
        <hr class="separator">
        <p>${answer}</p>
      </div>
    `;
}

// ============================================================
// 3. 이벤트 바인딩
// ============================================================

// 버튼 클릭 시 실행
document.getElementById("searchBtn").addEventListener("click", onRunAIButtonClicked);

// 엔터키 입력 시 실행
document.getElementById("playerInput").addEventListener("keydown", (e) => {
    if (e.key === "Enter") {
        e.preventDefault(); // 기본 폼 제출 방지
        onRunAIButtonClicked();
    }
});


// ============================================================
// 4. 기존 기능 유지 (자동완성 등)
// ============================================================
const playerDB = {
  "강민호": {name:"강민호"}, "디아즈": {name:"디아즈"}, "이재현": {name:"이재현"},
  "김영웅": {name:"김영웅"}, "류지혁": {name:"류지혁"}, "양도근": {name:"양도근"},
  "구자욱": {name:"구자욱"}, "김성윤": {name:"김성윤"}, "김지찬": {name:"김지찬"},
  "박승규": {name:"박승규"}, "김헌곤": {name:"김헌곤"}, "최형우": {name:"최형우"},
  "후라도": {name:"후라도"}, "원태인": {name:"원태인"}, "최원태": {name:"최원태"},
  "김태훈": {name:"김태훈"}, "양창섭": {name:"양창섭"}, "김재윤": {name:"김재윤"},
  "이호성": {name:"이호성"}, "이승현": {name:"이승현"}, "이승민": {name:"이승민"},
  "배찬승": {name:"배찬승"}, "백정현": {name:"백정현"}
};

const input = document.getElementById("playerInput");
const autoList = document.getElementById("autocompleteList");

input.addEventListener("input", () => {
  const keyword = input.value.trim();
  autoList.innerHTML = "";

  if (!keyword) {
    autoList.style.display = "none";
    return;
  }

  const matches = Object.keys(playerDB).filter(name => name.includes(keyword));
  if (matches.length === 0) {
    autoList.style.display = "none";
    return;
  }

  matches.forEach(name => {
    const item = document.createElement("div");
    item.className = "autocomplete-item";
    item.textContent = name;
    item.onclick = () => {
      input.value = name;
      autoList.style.display = "none";
      // 자동완성 클릭 시에도 바로 검색 실행
      onRunAIButtonClicked();
    };
    autoList.appendChild(item);
  });
  autoList.style.display = "block";
});

document.addEventListener("click", (e) => {
  if (!e.target.closest(".search-box")) {
    autoList.style.display = "none";
  }
});
</script>

</body>
</html>

